More use of fuctions, loops and nested loops
